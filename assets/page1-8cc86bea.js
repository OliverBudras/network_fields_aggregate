import{G as y,S as w,N}from"./sigma-node-border.esm-f57be0f2.js";const b="/network_fields_aggregate",E=document.getElementById("sigma-container"),o=document.getElementById("node-info"),c=document.getElementById("slider-points"),$=document.getElementById("window-display"),x=document.getElementById("toggle-labels"),i=new y,l={selectedNode:null,selectedNeighbors:null};let p=!0;const d=new w(i,E,{renderLabels:!0,nodeProgramClasses:{border:N}});d.setSetting("labelRenderedSizeThreshold",0);d.setSetting("nodeReducer",(s,e)=>l.selectedNeighbors&&!l.selectedNeighbors.has(s)?{...e,color:"#f6f6f6"}:e);d.setSetting("edgeReducer",(s,e)=>l.selectedNeighbors&&l.selectedNode&&!i.hasExtremity(s,l.selectedNode)?{...e,hidden:!0}:e);d.on("clickNode",({node:s})=>{if(l.selectedNode===s)l.selectedNode=null,l.selectedNeighbors=null,o.style.display="none";else{l.selectedNode=s,l.selectedNeighbors=new Set(i.neighbors(s)),l.selectedNeighbors.add(s);const e=i.getNodeAttributes(s);o.innerHTML=`
<div><b>Node Information</b></div>
<div class="field"><span class="label">Field:</span><span class="value">${e.id??""}</span></div>
<div class="field"><span class="label">Citations:</span><span class="value">${e.citations??""}</span></div>
<div class="field"><span class="label">Nodes:</span><span class="value">${e.numbernodes??""}</span></div>
<div class="field"><span class="label">Degree:</span><span class="value">${e.degree??""}</span></div>
<div class="field"><span class="label">Betweeness:</span><span class="value">${e.betweeness??""}</span></div>
<div class="field"><span class="label">Closeness:</span><span class="value">${e.closeness??""}</span></div>
<div class="field"><span class="label">Edges (Between):</span><span class="value">${e.between_edges??""}</span></div>
<div class="field"><span class="label">Edges (Within):</span><span class="value">${e.withinedges??""}</span></div>
<div class="field"><span class="label">Edges (Total):</span><span class="value">${e.totaledges??""}</span></div>
<div class="field"><span class="label">External Edge Ratio:</span><span class="value">${e.externalratio??""}</span></div>
<div class="field"><span class="label">Internal Edge Ratio:</span><span class="value">${e.internalratio??""}</span></div>`,o.style.display="block"}d.refresh()});d.on("clickStage",()=>{l.selectedNode=null,l.selectedNeighbors=null,o.style.display="none",d.refresh()});function S(s,e){const n=e>0?Math.min(Math.max(s/e,0),1):0,a=Math.round(250*(1-n));return`#${((1<<24)+(a<<16)+(a<<8)+a).toString(16).slice(1)}`}async function f(s){const n=s+11,a=await fetch(`${b}/windows_field_aggregate/nodes_window_${String(n).padStart(3,"0")}.json`).then(t=>t.json()),r=await fetch(`${b}/windows_field_aggregate/edges_window_${String(n).padStart(3,"0")}.json`).then(t=>t.json()),m=r.reduce((t,g)=>Math.max(t,g.weight??0),0);i.clear(),a.forEach(t=>{i.addNode(t.id,{...t,x:typeof t.x=="number"?t.x:Math.random(),y:typeof t.y=="number"?t.y:Math.random(),size:t.size_nodes,color:t.color??"#666",type:"border",borderColor:"#000",label:p?t.label?.length>30?t.label.slice(0,30)+"â€¦":t.label:"",fullTitle:t.label,opacity:1})}),r.forEach(t=>{const g=Number(t.weight)||0;i.addEdge(t.source,t.target,{...t,color:S(g,m),size:1})}),$.textContent=a.length>0&&a[0].window?a[0].window:`Window ${s+1}`,I(s),d.refresh();const h=document.getElementById("node-display");h&&(h.textContent=`${a.length} Nodes`);const u=document.getElementById("edge-display");u&&(u.textContent=`${r.length} Edges`)}const v=40;function B(){c.innerHTML="";for(let s=0;s<v;s++){const e=document.createElement("div");if(e.className="slider-point",e.style.left=s/(v-1)*100+"%",s%5===0){const n=document.createElement("div");n.className="tick-label",n.textContent=`${1980+s}-${1980+s+4}`,e.appendChild(n)}e.addEventListener("click",()=>f(s)),c.appendChild(e)}}function I(s){const e=c.children;for(let n=0;n<e.length;n++)e[n].classList.toggle("active",n===s)}x.addEventListener("click",()=>{p=!p,d.refresh();const s=Array.from(c.children).findIndex(e=>e.classList.contains("active"));s>=0&&f(s)});B();f(0);
