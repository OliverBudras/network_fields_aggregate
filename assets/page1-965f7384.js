import{G as v,S as m,N as w}from"./sigma-node-border.esm-f57be0f2.js";const y=document.getElementById("sigma-container"),r=document.getElementById("node-info"),g=document.getElementById("slider-points"),N=document.getElementById("window-display"),$=document.getElementById("toggle-labels"),i=new v,l={selectedNode:null,selectedNeighbors:null};let p=!0;const a=new m(i,y,{renderLabels:!0,nodeProgramClasses:{border:w}});a.setSetting("labelRenderedSizeThreshold",0);a.setSetting("nodeReducer",(s,e)=>l.selectedNeighbors&&!l.selectedNeighbors.has(s)?{...e,color:"#f6f6f6"}:e);a.setSetting("edgeReducer",(s,e)=>l.selectedNeighbors&&l.selectedNode&&!i.hasExtremity(s,l.selectedNode)?{...e,hidden:!0}:e);a.on("clickNode",({node:s})=>{if(l.selectedNode===s)l.selectedNode=null,l.selectedNeighbors=null,r.style.display="none";else{l.selectedNode=s,l.selectedNeighbors=new Set(i.neighbors(s)),l.selectedNeighbors.add(s);const e=i.getNodeAttributes(s);r.innerHTML=`
<div><b>Node Information</b></div>
<div class="field"><span class="label">Field:</span><span class="value">${e.id??""}</span></div>
<div class="field"><span class="label">Citations:</span><span class="value">${e.citations??""}</span></div>
<div class="field"><span class="label">Nodes:</span><span class="value">${e.numbernodes??""}</span></div>
<div class="field"><span class="label">Degree:</span><span class="value">${e.degree??""}</span></div>
<div class="field"><span class="label">Betweeness:</span><span class="value">${e.betweeness??""}</span></div>
<div class="field"><span class="label">Closeness:</span><span class="value">${e.closeness??""}</span></div>
<div class="field"><span class="label">Edges (Between):</span><span class="value">${e.between_edges??""}</span></div>
<div class="field"><span class="label">Edges (Within):</span><span class="value">${e.withinedges??""}</span></div>
<div class="field"><span class="label">Edges (Total):</span><span class="value">${e.totaledges??""}</span></div>
<div class="field"><span class="label">External Edge Ratio:</span><span class="value">${e.externalratio??""}</span></div>
<div class="field"><span class="label">Internal Edge Ratio:</span><span class="value">${e.internalratio??""}</span></div>`,r.style.display="block"}a.refresh()});a.on("clickStage",()=>{l.selectedNode=null,l.selectedNeighbors=null,r.style.display="none",a.refresh()});function E(s,e=100){const t=Math.min(Math.max(s/e,0),1),o=255,d=Math.round(200*(1-t)),c=Math.round(200*(1-t));return`rgb(${o},${d},${c})`}async function f(s){const e="/network_fields_aggregate",o=s+11,d=await fetch(`${e}/windows_field_aggregate/nodes_window_${String(o).padStart(3,"0")}.json`).then(n=>n.json()),c=await fetch(`${e}/windows_field_aggregate/edges_window_${String(o).padStart(3,"0")}.json`).then(n=>n.json()),b=c.reduce((n,u)=>Math.max(n,u.weight??0),0);i.clear(),d.forEach(n=>{i.addNode(n.id,{...n,x:typeof n.x=="number"?n.x:Math.random(),y:typeof n.y=="number"?n.y:Math.random(),size:n.size_nodes,color:n.color??"#666",type:"border",borderColor:"#000",label:p?n.label?.length>30?n.label.slice(0,30)+"â€¦":n.label:"",fullTitle:n.label,opacity:1})}),c.forEach(n=>{i.addEdge(n.source,n.target,{...n,color:E(n.weight??0,b),size:1})}),N.textContent=d.length>0&&d[0].window?d[0].window:`Window ${s+1}`,S(s),a.refresh()}const h=40;function x(){g.innerHTML="";for(let s=0;s<h;s++){const e=document.createElement("div");if(e.className="slider-point",e.style.left=s/(h-1)*100+"%",s%5===0){const t=document.createElement("div");t.className="tick-label",t.textContent=`${1980+s}-${1980+s+4}`,e.appendChild(t)}e.addEventListener("click",()=>f(s)),g.appendChild(e)}}function S(s){const e=g.children;for(let t=0;t<e.length;t++)e[t].classList.toggle("active",t===s)}$.addEventListener("click",()=>{p=!p,a.refresh();const s=Array.from(g.children).findIndex(e=>e.classList.contains("active"));s>=0&&f(s)});x();f(0);
